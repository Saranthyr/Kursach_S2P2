<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link rel="stylesheet" type="text/css" href="../static/css/styles.css">
</head>
<body>
<div class="wrapper">
    <label for="file">Select video for conversion</label>
    <input type="file" accept="video/*" id="file">
    <select name="kek" id="ext">
        <option value="no_change" selected>Don't change</option>
        <option value=".mp4">.mp4</option>
        <option value=".mkv">.mkv</option>
    </select>
    <div class="w1">
        <div class="w2">
            <label for="upsc">Upscale</label>
            <input type="checkbox" value="upscale" id="upsc">
        </div>
        <div class="w3">
            <label for="quality">Quality</label>
            <select id="quality">
                <option value="FullHD" selected>FullHD</option>
                <option value="2K">2K</option>
                <option value="4K">4K</option>
            </select>
        </div>
    </div>
    <input type="button" id="button" value="Submit">
</div>
</body>
</html>
<script>
const upscale = document.getElementById('upsc');
upscale.addEventListener('toggle', function () {
    if (upscale.checked) {
        document.getElementById('quality').setAttribute('hidden', 'false');
        document.getElementById('quality').setAttribute('disabled', 'false');
    }
    else {
        document.getElementById('quality').setAttribute('hidden', 'true');
        document.getElementById('quality').setAttribute('disabled', 'true');
    }
})
document.getElementById('file').addEventListener('input', function () {
    var file = document.getElementById('file').files[0];
    var url = URL.createObjectURL(file);
    var vid = document.createElement('video');
    vid.setAttribute('src', url);
    vid.addEventListener('loadedmetadata', function (e) {
        console.log(e.target.videoWidth, e.target.videoHeight);
    })
})
document.getElementById('button').addEventListener('click', async function sd() {
    var file = document.getElementById('file').files[0];
    console.log(document.getElementById('file').value);
    var url = URL.createObjectURL(file);
    vid = document.createElement('video');
    vid.setAttribute('src', url);
    let fd = new FormData();
    if (upscale.checked == true) {
        fd.append("upscale", "up");
        fd.append("quality", document.getElementById("quality").value);
    }
    fd.append("file", file);
    fd.append("filename", document.getElementById('file').value);
    fd.append("ext", document.getElementById("ext").value);
    let response = await fetch('/feat/convert', {method: 'POST', body: fd});
    })
</script>
